<script src="~/Scripts/jquery-1.12.4.js"></script>
<link href="~/assets/css/plugins/toastr/toastr.css" rel="stylesheet" />
<script src="~/assets/css/plugins/toastr/toastr.min.js"></script>
<script src="~/Scripts/jquery.validate.min.js"></script>
<script src="~/Scripts/jquery.validate.unobtrusive.min.js"></script>
<script src="~/Scripts/autocomplete/jquery.autocomplete.js"></script>
@model mvc.Models.EditClient
@using PagedList;
@using PagedList.Mvc;
@using GridMvc.Html

@{
    Layout = null;
}
<!DOCTYPE html>



<div class="modal-dialog" id="pnl-mdlCandidate">

    @using (Html.BeginForm(null, null, FormMethod.Post, new { @class = "", @id = "frmCandidate" }))
    {
        <div class="modal-content" style="width:740px;">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">×</button>
                <h3 class="modal-title">Edit Client</h3>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-sm-6">
                        <div class="form-group">
                            <label>Busyness Type <span class="text-danger">*</span></label>
                            @Html.TextBoxFor(a => a.BuisinessType, new { @class = "form-control ", @id = "BusinessTypeList", placeholder = "Busyness type" })
                            @Html.HiddenFor(model => model.buissType_id, new { id = "buissType_id" })
                            <p id="business" style="color:red;">select business type</p>

                        </div>

                        <div class="form-group">
                            <label>Location <span class="text-danger">*</span></label>
                            @Html.TextBoxFor(a => a.loc_desc, new { @class = "form-control ", @id = "LocationList", placeholder = "Location" })
                            @Html.HiddenFor(model => model.location_id, new { @id = "location_id" })
                            <p id="location" style="color:red;">select Location</p>

                        </div>

                        <div class="form-group">
                            <label for="name">Adress<span class="text-danger">*</span></label>
                            @Html.TextBoxFor(a => a.address, new { @class = "form-control", placeholder = "Enter Adress", title = "address", @id = "address" })
                            <p id="adress" style="color:red;">Enter adress</p>

                        </div>

                        <div class="form-group">
                            <label for="name">Compatitors</label>
                            @Html.TextBoxFor(a => a.compitators, new { @class = "form-control", placeholder = "Enter Compatitors", title = "compitators", @id = "compitators" })

                        </div>
                        <div class="form-group">
                            <label for="name">Manifacturing</label>
                            @Html.TextBoxFor(a => a.Manifactring, new { @class = "form-control", placeholder = "Enter Manifacturing", title = "Manifactring", @id = "Manifactring" })

                        </div>

                    </div>

                    <div class="col-sm-6">

                        <div class="form-group">
                            <label for="name">Client Name<span class="text-danger">*</span></label>
                            @Html.TextBoxFor(a => a.Client_Name, new { @class = "form-control", placeholder = "Enter Client Name", title = "Client_Name", @id = "Client_Name" })
                            @Html.HiddenFor(model => model.client_id, new { id = "client_id" })
                            <p id="clientname" style="color:red;">Enter Client Name</p>
                        </div>
                        <div class="form-group">
                            <label>Client Type <span class="text-danger">*</span></label>
                            @Html.TextBoxFor(a => a.ct_description, new { @class = "form-control ", @id = "ClientTypeList", placeholder = "client type name" })
                            @Html.HiddenFor(model => model.Client_Type_id, new { id = "Client_Type_id" })
                            <p id="clientype" style="color:red;">select client type</p>

                        </div>


                        <div class="form-group">
                            <label for="name">products</label>
                            @Html.TextBoxFor(a => a.products, new { @class = "form-control", placeholder = "Enter product", title = "products", @id = "products" })


                        </div>
                        <div class="form-group">
                            <label for="name">DID No</label>
                            @Html.TextBoxFor(a => a.DID_no, new { @class = "form-control", placeholder = "Enter DID number", title = "DID_no", @id = "DID_no" })

                        </div>
                        <div class="form-group">
                            <label for="name">Fax No</label>
                            @Html.TextBoxFor(a => a.fax_no, new { @class = "form-control", placeholder = "Enter fax no", title = "fax_no", @id = "fax_no" })

                        </div>

                    </div>

                </div>


            </div>
            <div class="modal-footer">
                <button type="submit" id="btnsave" class="btn btn-primary">update</button>
                @Html.ActionLink("Cancel", "IndexForBusinessDev", "BussinessDev", null, new { @class = "btn btn-default" })
            </div>
        </div>
    }
</div>


<script>

    $(document).ready(function () {

        getLocation();
        getbusinesstrype();
        getclienttype();

         $("#business").hide();
        $("#location").hide();
        $("#adress").hide();
        $("#clientname").hide();
        $("#clientype").hide();
            $('#btnsave').on('click', function () {

                if ($("#buissType_id").val() == "") {
                    $("#business").show();
                    $("#location").hide();
                    $("#adress").hide();
                    $("#clientname").hide();
                    $("#clientype").hide();
                    return false;
                }
                else if ($("#location_id").val() == "") {
                    $("#business").hide();
                    $("#location").show();
                    $("#adress").hide();
                    $("#clientname").hide();
                    $("#clientype").hide();
                    return false;
                }
                else if ($("#address").val() == "") {
                    $("#business").hide();
                    $("#location").hide();
                    $("#adress").show();
                    $("#clientname").hide();
                    $("#clientype").hide();
                    return false;
                }
                else if ($("#Client_Name").val() == "") {
                    $("#business").hide();
                    $("#location").hide();
                    $("#adress").hide();
                    $("#clientname").show();
                    $("#clientype").hide();
                    return false;
                }
                else if ($("#Client_Type_id").val() == "") {
                    $("#business").hide();
                    $("#location").hide();
                    $("#adress").hide();
                    $("#clientname").hide();
                    $("#clientype").show();
                    return false;
                }
                else {

                    $.ajax({
                        type: 'POST',
                        dataType: 'json',
                        url: '/BussinessDev/Edit_ClientBusiness',

                        data:
                            {
                                client_id: $("#client_id").val(),
                                Client_Name: $("#Client_Name").val(),
                                Client_Type_id: $("#Client_Type_id").val(),
                                location_id: $("#location_id").val(),
                                address: $("#address").val(),
                                DID_no: $("#DID_no").val(),
                                fax_no: $("#fax_no").val(),
                                Manifactring: $("#Manifactring").val(),
                                products: $("#products").val(),
                                compitators: $("#compitators").val(),
                                buissType_id: $("#buissType_id").val(),


                            },
                              success: function (da) {
                            //alert("data inserted sucessfully");
                            toastr.success("Client Updated Sucessfully.");
                                  $("#mdlEditClient .close").click()
                                  refresh();

                        },

                        error: function (XMLHttpRequest, textStatus, errorThrown) {

                        }
                    });
                    return false;

                }

                return false;
            });


    });


    function refresh()
    {
        $.ajax({
            type: 'POST',
            dataType: 'json',
            url: '/Master/BusinessDevList',

            data:
                {

                    page: 1,
                    Name: null,

                },
            success: function (da) {
                //alert("data inserted sucessfully");
                toastr.success("Client gride refreshed");
                $("#mdlEditClient .close").click()

            },

            error: function (XMLHttpRequest, textStatus, errorThrown) {

            }
        });
        return true;
    }

     //================================================================autocomplete code===================================================
     function getLocation()
    {
             var returnResult = [];
                          $.ajax({
                        contentType: "application/json; charset=utf-8",
                         url: "@Url.Action("GetLocationList", "Master")",
                        method: 'GET',
                        async: 'false',
                        dataType: 'json',
                        success: function (result) {
                            var data = $.map(result, function (obj) {
                                obj.value = obj.Text; // desired field
                                obj.data = obj.Value; // desired field
                                returnResult.push(obj);
                                $("#LocationList").autocomplete({
                                    lookup: returnResult,
                                    onSelect: function (suggestion) {
                                        $("#location_id").val(suggestion.data);

                                    }
                                });

                            });
                        },
                        error: function () { }
                  });
    }


      function getbusinesstrype()
    {
             var returnResult = [];
                          $.ajax({
                        contentType: "application/json; charset=utf-8",
                         url: "@Url.Action("GetbusinesstypeList", "Master")",
                        method: 'GET',
                        async: 'false',
                        dataType: 'json',
                        success: function (result) {
                            var data = $.map(result, function (obj) {
                                obj.value = obj.Text; // desired field
                                obj.data = obj.Value; // desired field
                                returnResult.push(obj);
                                $("#BusinessTypeList").autocomplete({
                                    lookup: returnResult,
                                    onSelect: function (suggestion) {
                                        $("#buissType_id").val(suggestion.data);

                                    }
                                });

                            });
                        },
                        error: function () { }
                  });
    }

     function getclienttype()
    {
             var returnResult = [];
                          $.ajax({
                        contentType: "application/json; charset=utf-8",
                         url: "@Url.Action("GetclienttypeList", "Master")",
                        method: 'GET',
                        async: 'false',
                        dataType: 'json',
                        success: function (result) {
                            var data = $.map(result, function (obj) {
                                obj.value = obj.Text; // desired field
                                obj.data = obj.Value; // desired field
                                returnResult.push(obj);
                                $("#ClientTypeList").autocomplete({
                                    lookup: returnResult,
                                    onSelect: function (suggestion) {
                                        $("#Client_Type_id").val(suggestion.data);

                                    }
                                });

                            });
                        },
                        error: function () { }
                  });
    }




</script>



